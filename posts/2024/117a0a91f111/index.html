<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Java最强本地缓存——Caffeine | Yonagi's Sekai</title><meta name="author" content="Yonagi"><meta name="copyright" content="Yonagi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="缓存（Cache）在计算机中无处不在。缓存本质上是一种用空间换时间的手段——通过将数据存储在更快的存储媒介上，减少响应的时间，使得下一次访问这些数据的时候能够获得加速的效果。从缓存类型来看，缓存还分为 本地缓存 和 分布式缓存 两种类型。分布式缓存（如 Redis 集群）除了要解决数据读取效率问题外，还要解决集群环境下的数据不一致问题。本文将简单地介绍一种高性能的本地缓存库——Caffeine，以"><meta property="og:type" content="article"><meta property="og:title" content="Java最强本地缓存——Caffeine"><meta property="og:url" content="https://yonagi04.github.io/posts/2024/117a0a91f111/index.html"><meta property="og:site_name" content="Yonagi's Sekai"><meta property="og:description" content="缓存（Cache）在计算机中无处不在。缓存本质上是一种用空间换时间的手段——通过将数据存储在更快的存储媒介上，减少响应的时间，使得下一次访问这些数据的时候能够获得加速的效果。从缓存类型来看，缓存还分为 本地缓存 和 分布式缓存 两种类型。分布式缓存（如 Redis 集群）除了要解决数据读取效率问题外，还要解决集群环境下的数据不一致问题。本文将简单地介绍一种高性能的本地缓存库——Caffeine，以"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://yonagi04.github.io/img/website/6.webp"><meta property="article:published_time" content="2024-07-25T09:47:32.000Z"><meta property="article:modified_time" content="2025-05-18T09:07:25.408Z"><meta property="article:author" content="Yonagi"><meta property="article:tag" content="Java"><meta property="article:tag" content="后端"><meta property="article:tag" content="Caffeine"><meta property="article:tag" content="缓存技术"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://yonagi04.github.io/img/website/6.webp"><link rel="shortcut icon" href="/img/website/favicon.ico"><link rel="canonical" href="https://yonagi04.github.io/posts/2024/117a0a91f111/index.html"><link rel="preconnect" href="https://jsd.onmicrosoft.cn"><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css"><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?52d11ede054dec6c371b75e69da27bcd";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(){function n(n){return atob(n)}var o=n("eW9uYWdpMDQuZ2l0aHViLmlv"),a=n("YmxvZy55b25hZ2kwNC5jbg=="),i=n("bG9jYWxob3N0"),t=n("aHR0cHM6Ly9ibG9nLnlvbmFnaTA0LmNu"),b=document.location.hostname;b!==o&&b!==a&&b!==i&&(confirm("警告：您当前浏览的页面非官方页面，可能存在有害信息！建议您跳转至官方页面进行浏览！"),window.location.href=t)}()</script><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"JZ6HA6I3QE",apiKey:"cbf7b613baa375f6ca611ad89be8045a",indexName:"hexo-blog",hits:{per_page:6},languages:{input_placeholder:"搜索文章",hits_empty:"找不到您查询的内容：${query}",hits_stats:"找到 ${hits} 条结果，用时 ${time} 毫秒"}},localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},noticeOutdate:{limitDay:500,position:"top",messagePrev:"It has been",messageNext:"days since the last update, the content of the article may be outdated."},highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: Yonagi",link:"链接: ",source:"来源: Yonagi's Sekai",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体中文",cht_to_chs:"你已切换为简体中文",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"top-right"},infinitegrid:{js:"https://jsd.onmicrosoft.cn/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Java最强本地缓存——Caffeine",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2025-05-18 09:07:25"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),document.head.appendChild(n)})),e.getCSS=(e,t=!1)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=(new Date).getHours();void 0===t?o<=6||o>=18?activateDarkMode():activateLightMode():"light"===t?activateLightMode():activateDarkMode();const a=saveToLocal.get("aside-status");void 0!==a&&("hide"===a?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/modify.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.25/css/butterfly-double-row-display/cardlistpost.min.css"></head><body><svg aria-hidden="true" style="position:absolute;overflow:hidden;width:0;height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248 626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/yonagi-blog-repo-img@1.1.17/css/swiper/swiper.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/yonagi-blog-repo-img@1.1.17/css/swiper/swiperstyle.css" media="print" onload='this.media="all"'><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="Yonagi's Sekai" type="application/atom+xml"><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",(()=>{preloader.endLoading()})),document.addEventListener("pjax:send",(()=>{preloader.initLoading()})),document.addEventListener("pjax:complete",(()=>{preloader.endLoading()}))</script><script>window.paceOptions={restartOnPushState:!1},document.addEventListener("pjax:send",(()=>{Pace.restart()}))</script><link rel="stylesheet" href="/css/progress_bar.css"><script src="https://jsd.onmicrosoft.cn/npm/pace-js@1.2.4/pace.min.js"></script><div id="web_bg"></div><div id="an_music_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/website/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">118</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i> <span>文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="javascript:randomPost();"><i class="fa-fw fas fa-random"></i> <span>随机访问</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-coffee"></i> <span>休息时间</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-video"></i> <span>看番时间</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://music.yonagi04.cn"><i class="fa-fw fas fa-music"></i> <span>听歌时间</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://game.yonagi04.cn"><i class="fa-fw fas fa-gamepad"></i> <span>游戏时间</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/zone/"><i class="fa-fw fas fa-comments"></i> <span>说说</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-info-circle"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-user"></i> <span>关于我</span></a></li><li><a class="site-page child" href="/update/"><i class="fa-fw fas fa-history"></i> <span>更新日志</span></a></li><li><a class="site-page child" href="/license/"><i class="fa-fw fas fa-file-alt"></i> <span>声明</span></a></li><li><a class="site-page child" href="/message/"><i class="fa-fw fas fa-comment"></i> <span>留言板</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://status.yonagi04.cn"><i class="fa-fw fas fa-desktop"></i> <span>站点监测</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-train-subway"></i> <span>开往</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url('/img/website/6.webp')"><nav id="nav"><span id="blog-info"><a href="/" title="Yonagi's Sekai"><img class="site-icon" src="/img/website/favicon.ico"><span class="site-name">Yonagi's Sekai</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-archive"></i> <span>文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li><li><a class="site-page child" href="javascript:randomPost();"><i class="fa-fw fas fa-random"></i> <span>随机访问</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-coffee"></i> <span>休息时间</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-video"></i> <span>看番时间</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://music.yonagi04.cn"><i class="fa-fw fas fa-music"></i> <span>听歌时间</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://game.yonagi04.cn"><i class="fa-fw fas fa-gamepad"></i> <span>游戏时间</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/zone/"><i class="fa-fw fas fa-comments"></i> <span>说说</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-info-circle"></i> <span>关于</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-user"></i> <span>关于我</span></a></li><li><a class="site-page child" href="/update/"><i class="fa-fw fas fa-history"></i> <span>更新日志</span></a></li><li><a class="site-page child" href="/license/"><i class="fa-fw fas fa-file-alt"></i> <span>声明</span></a></li><li><a class="site-page child" href="/message/"><i class="fa-fw fas fa-comment"></i> <span>留言板</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://status.yonagi04.cn"><i class="fa-fw fas fa-desktop"></i> <span>站点监测</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-train-subway"></i> <span>开往</span></a></div></div><center id="name-container"><a id="page-name" href="javascript:rmf.scrollToTop()">PAGE_NAME</a></center></div><div id="nav-right"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i></a></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Java最强本地缓存——Caffeine</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-25T09:47:32.000Z" title="发表于 2024-07-25 09:47:32">2024-07-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-18T09:07:25.408Z" title="更新于 2025-05-18 09:07:25">2025-05-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/">后端技术</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Java最强本地缓存——Caffeine"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image:url('/img/website/6.webp')"></div><article class="post-content" id="article-container"><p>缓存（Cache）在计算机中无处不在。缓存本质上是一种用空间换时间的手段——通过将数据存储在更快的存储媒介上，减少响应的时间，使得下一次访问这些数据的时候能够获得加速的效果。从缓存类型来看，缓存还分为 <strong>本地缓存</strong> 和 <strong>分布式缓存</strong> 两种类型。分布式缓存（如 Redis 集群）除了要解决数据读取效率问题外，还要解决集群环境下的数据不一致问题。本文将简单地介绍一种高性能的本地缓存库——Caffeine，以及Caffeine 的使用、驱逐策略、刷新策略，以及如何在 SpringBoot 中使用 Caffeine</p><h2 id="Caffeine-简介">Caffeine 简介</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZQ==">Caffeine</a> 是基于Java 1.8的高性能本地缓存库，由 Guava 演变而来，它的性能比Guava也更好，官方声称在基准测试中， <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL0JlbmNobWFya3M=">Caffeine 的缓存命中率已经接近于最优值</a>，且 <a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL01lbW9yeS1vdmVyaGVhZA==">Caffeine 的内存占用情况也优于 Guava</a></p><p>实际上，Caffeine 这种本地缓存和 ConcurrentHashMap 很像——都支持并发，都支持 O(1) 时间复杂度的存取。两者的主要区别在于：</p><ul><li>ConcurrentHashMap 会存储所有存入的数据，且数据移除需要进行显式的操作</li><li>Caffeine 将通过给定的配置，自动移除不常用的数据，节约内存空间</li></ul><p>因此，我们可以粗略地将Caffeine视为带有淘汰策略的ConcurrentHashMap</p><p>根据 Caffeine 官方提供的文档，Caffeine提供的功能如下：</p><ul><li><a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL1BvcHVsYXRpb24temgtQ04=">自动加载</a>元素到缓存当中，异步加载的方式也可供选择</li><li>当达到最大容量的时候可以使用基于<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL0VmZmljaWVuY3ktemgtQ04=">就近度和频率</a>的算法进行<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL0V2aWN0aW9uLXpoLUNOIyVFNSU5RiVCQSVFNCVCQSU4RSVFNSVBRSVCOSVFOSU4NyU4Rg==">基于容量的驱逐</a></li><li>将根据缓存中的元素上一次访问或者被修改的时间进行<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL0V2aWN0aW9uLXpoLUNOIyVFNSU5RiVCQSVFNCVCQSU4RSVFNiU5NyVCNiVFOSU5NyVCNA==">基于过期时间的驱逐</a></li><li>当向缓存中一个已经过时的元素进行访问的时候将会进行<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL1JlZnJlc2gtemgtQ04=">异步刷新</a></li><li>key将自动被<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL0V2aWN0aW9uLXpoLUNOIyVFNSU5RiVCQSVFNCVCQSU4RSVFNSVCQyU5NSVFNyU5NCVBOA==">弱引用</a>所封装</li><li>value将自动被<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL0V2aWN0aW9uLXpoLUNOIyVFNSU5RiVCQSVFNCVCQSU4RSVFNSVCQyU5NSVFNyU5NCVBOA==">弱引用或者软引用</a>所封装</li><li>驱逐(或移除)缓存中的元素时将会进行<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL1JlbW92YWwtemgtQ04=">通知</a></li><li><a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL1dyaXRlci16aC1DTg==">写入传播</a>到一个外部数据源当中</li><li>持续计算缓存的访问<a target="_blank" rel="external nofollow noopener noreferrer" href="/go.html?u=aHR0cHM6Ly9naXRodWIuY29tL2Jlbi1tYW5lcy9jYWZmZWluZS93aWtpL1N0YXRpc3RpY3MtemgtQ04=">统计指标</a></li></ul><h2 id="在-Java-中使用-Caffeine">在 Java 中使用 Caffeine</h2><p>为了使用 Caffeine，在 Maven 工程下引入以下依赖：</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.ben-manes.caffeine<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>caffeine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>Caffeine 提供了四种缓存添加策略：手动加载，自动加载，手动异步加载和自动异步加载</p><h3 id="手动加载">手动加载</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Cache&lt;Key, Graph&gt; cache = Caffeine.newBuilder()</span><br><span class="line">    .expireAfterWrite(<span class="number">10</span>, TimeUnit.MINUTES)</span><br><span class="line">    .maximumSize(<span class="number">10_000</span>)</span><br><span class="line">    .build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查找一个缓存元素， 没有查找到的时候返回null</span></span><br><span class="line"><span class="type">Graph</span> <span class="variable">graph</span> <span class="operator">=</span> cache.getIfPresent(key);</span><br><span class="line"><span class="comment">// 查找缓存，如果缓存不存在则生成缓存元素,  如果无法生成则返回null</span></span><br><span class="line">graph = cache.get(key, k -&gt; createExpensiveGraph(key));</span><br><span class="line"><span class="comment">// 添加或者更新一个缓存元素</span></span><br><span class="line">cache.put(key, graph);</span><br><span class="line"><span class="comment">// 移除一个缓存元素</span></span><br><span class="line">cache.invalidate(key);</span><br></pre></td></tr></tbody></table></figure><p>Cache 接口提供了显式搜索查找、更新和移除缓存元素的能力</p><p><code>cache.put(key, value)</code> 操作将会直接写入或更新缓存中的缓存元素，在缓存中已经存在的该 key 对应的缓存值都会被直接覆盖</p><p><code>cache.get(key, k -&gt; value)</code> 操作来在缓存中不存在该key对应的缓存元素的时候进行计算生成并直接写入至缓存内，而当该key对应的缓存元素存在的时候将会直接返回存在的缓存值。如果缓存的元素无法生成或在生成的过程中抛出了异常导致生成失败，<code>cache.get</code> 可能会返回null</p><p>通过调用 <code>cache.invalidate(key)</code> 方法来移除缓存</p><h3 id="自动加载">自动加载</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">LoadingCache&lt;Key, Graph&gt; cache = Caffeine.newBuilder()</span><br><span class="line">    .maximumSize(<span class="number">10_000</span>)</span><br><span class="line">    .expireAfterWrite(<span class="number">10</span>, TimeUnit.MINUTES)</span><br><span class="line">    .build(key -&gt; createExpensiveGraph(key));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查找缓存，如果缓存不存在则生成缓存元素,  如果无法生成则返回null</span></span><br><span class="line"><span class="type">Graph</span> <span class="variable">graph</span> <span class="operator">=</span> cache.get(key);</span><br><span class="line"><span class="comment">// 批量查找缓存，如果缓存不存在则生成缓存元素</span></span><br><span class="line">Map&lt;Key, Graph&gt; graphs = cache.getAll(keys);</span><br></pre></td></tr></tbody></table></figure><p><code>LoadingCache</code> 是一个 <code>Cache</code> 附加上 <code>CacheLoader</code> 能力后的缓存实现</p><p>当缓存不存在时，如果调用了<code>get()</code>方法，则会调用<code>CacheLoader.load()</code>方法加载最新值。通过 <code>getAll()</code> 可以达到批量查找缓存的目的。通常情况下，<code>getAll()</code> 方法会对每个不存在对应缓存的key调用一次 <code>CacheLoader.load()</code> 来生成缓存元素</p><p>使用 <code>LoadingCache</code> 时，需要指定 <code>CacheLoader</code> ，并实现其中的 <code>load()</code> 方法供缓存缺失时的自动加载</p><h3 id="手动异步加载">手动异步加载</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">AsyncCache&lt;Key, Graph&gt; cache = Caffeine.newBuilder()</span><br><span class="line">    .expireAfterWrite(<span class="number">10</span>, TimeUnit.MINUTES)</span><br><span class="line">    .maximumSize(<span class="number">10_000</span>)</span><br><span class="line">    .buildAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查找一个缓存元素， 没有查找到的时候返回null</span></span><br><span class="line">CompletableFuture&lt;Graph&gt; graph = cache.getIfPresent(key);</span><br><span class="line"><span class="comment">// 查找缓存元素，如果不存在，则异步生成</span></span><br><span class="line">graph = cache.get(key, k -&gt; createExpensiveGraph(key));</span><br><span class="line"><span class="comment">// 添加或者更新一个缓存元素</span></span><br><span class="line">cache.put(key, graph);</span><br><span class="line"><span class="comment">// 移除一个缓存元素</span></span><br><span class="line">cache.synchronous().invalidate(key);</span><br></pre></td></tr></tbody></table></figure><p><code>AsyncCache</code> 是 <code>Cache</code> 的一个变体，响应结果均为 <code>CompletableFuture</code>。默认情况下，缓存计算使用 <code>ForkJoinPool.commonPool()</code>作为线程池，如果想要指定线程池，可以覆盖并实现 <code>Caffeine.executor(Executor)</code> 方法</p><p><code>synchronous()</code> 提供了阻塞直到异步缓存生成完毕的能力，它将以 Cache 进行返回</p><h3 id="自动异步加载">自动异步加载</h3><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">AsyncLoadingCache&lt;Key, Graph&gt; cache = Caffeine.newBuilder()</span><br><span class="line">    .maximumSize(<span class="number">10_000</span>)</span><br><span class="line">    .expireAfterWrite(<span class="number">10</span>, TimeUnit.MINUTES)</span><br><span class="line">    <span class="comment">// 你可以选择: 去异步的封装一段同步操作来生成缓存元素</span></span><br><span class="line">    .buildAsync(key -&gt; createExpensiveGraph(key));</span><br><span class="line">    <span class="comment">// 你也可以选择: 构建一个异步缓存元素操作并返回一个future</span></span><br><span class="line">    .buildAsync((key, executor) -&gt; createExpensiveGraphAsync(key, executor));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查找缓存元素，如果其不存在，将会异步进行生成</span></span><br><span class="line">CompletableFuture&lt;Graph&gt; graph = cache.get(key);</span><br><span class="line"><span class="comment">// 批量查找缓存元素，如果其不存在，将会异步进行生成</span></span><br><span class="line">CompletableFuture&lt;Map&lt;Key, Graph&gt;&gt; graphs = cache.getAll(keys);</span><br></pre></td></tr></tbody></table></figure><p>一个 <code>AsyncLoadingCache</code> 是一个 <code>AsyncCache</code> 加上 <code>AsyncCacheLoader</code> 能力的实现</p><p>与自动加载 <code>LoadingCache</code> 类似，<code>AsyncLoadingCache</code> 也需要指定 <code>CacheLoader</code> ，同时需要实现 <code>load()</code> 方法供供缓存缺失时的自动加载。</p><p>默认以 <code>ForkJoinPool.commonPool()</code>作为线程池来提交，如果想要指定线程池，可以覆盖并实现 <code>AsyncCacheLoader.aysncLoad()</code> 方法</p><h3 id="驱逐策略">驱逐策略</h3><p>驱逐策略在创建缓存的时候进行指定。常用的有基于容量的驱逐和基于时间的驱逐。基于容量的驱逐需要指定缓存容量的最大值。当缓存容量达到最大时，Caffeine将使用LRU策略对缓存进行淘汰；基于时间的驱逐策略如字面意思，可以设置在最后访问/写入一个缓存经过指定时间后，自动进行淘汰。</p><p>驱逐策略可以自由组合，在任意驱逐策略生效后，该缓存将会被清除</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// 创建最大容量为1000的缓存</span></span><br><span class="line">Caffeine.newBuilder().maximumSize(<span class="number">1000</span>).build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个写入10h后过期的缓存</span></span><br><span class="line">Caffeine.newBuilder().expireAfterWrite(<span class="number">10</span>, TimeUnit.HOURS).build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个访问1h后过期的缓存</span></span><br><span class="line">Caffeine.newBuilder().expireAfterAccess(<span class="number">1</span>, TimeUnit.HOURS).build();</span><br></pre></td></tr></tbody></table></figure><h3 id="刷新机制">刷新机制</h3><p>刷新机制与驱逐完全不同，它可以通过 <code>LoadingCache.refresh(K)</code> 方法，异步地为 key 对应的缓存元素刷新一个新的值。与驱逐不同的是，在刷新时候如果查询缓存元素，其旧值将会被返回，知道元素刷新完毕后才能返回刷新后的新值</p><p>使用 <code>refreshAfterWrite()</code> 机制，Caffeine将在 key 允许刷新后的首次访问时，立即返回旧值，同时异步地对缓存值进行刷新，使得调用方不至于因为缓存驱逐而被阻塞。刷新机制只能适用于自动加载和自动异步加载</p><p>通过覆写 <code>Cache.reload()</code> 方法，将在刷新时使得旧缓存值参与其中</p><p>刷新操作将会异步执行在一个 <code>Executor</code> 上，默认的线程池实现是 <code>ForkJoinPool.commonPool()</code> ，也可以通过覆盖 <code>Caffeine.executor(Executor)</code> 方法自定义线程池的实现</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Caffeine.newBuilder().refreshAfterWrite(<span class="number">10</span>, TimeUnit.MINUTES).build(k -&gt; create(k));</span><br></pre></td></tr></tbody></table></figure><h3 id="统计">统计</h3><p>Caffeine 内置了数据收集功能，通过 <code>Caffeine.recordStats()</code> 方法可以打开数据收集功能。<code>Cache.stats()</code> 方法将会返回一个 <code>CacheStats</code> 对象，将会包含一些统计指标，例如</p><ul><li><code>hitRate()</code> 缓存命中率</li><li><code>evictionCount()</code> 被驱逐的缓存数量</li><li><code>averageLoadPenalty()</code> 新值被载入的平均耗时</li></ul><h2 id="在-SpringBoot-中使用-Caffeine">在 SpringBoot 中使用 Caffeine</h2><p>除了上面提及的方法之外，在 SpringBoot框架中，我们有一些更加方便的配置方法和管理功能</p><h3 id="SpringBoot-缓存管理器">SpringBoot 缓存管理器</h3><p>Spring从3.1版本开始就引入了对 Cache 的支持。定义了 <code>org.springframework.cache.Cache</code> 和 <code>org.springframework.cache.CacheManager</code> 接口，来统一不同的缓存技术，支持使用 <code>JCache(JSR-107)</code> 注解来简化开发</p><ul><li>Cache 接口包括了对缓存的各种操作集合，实际操作缓存时，是通过这些接口进行操作</li><li>Cache 接口下提供了各种 xxxCache 的实现，由于 Spring 从2.0版本后把默认的缓存组件由 Guava 替换为 Caffeine，因此这里需要用到的就是 <code>CaffeineCache</code> 类。</li><li>CacheManager 定义了创建、配置、获取、管理和控制多个唯一命名的的 Cache。这些 Cache 存在于 CacheManager 的上下文中</li></ul><p>创建缓存管理器</p><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> CacheManager <span class="title function_">cacheManager</span><span class="params">()</span> {</span><br><span class="line">    <span class="type">SimpleCacheManager</span> <span class="variable">cacheManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleCacheManager</span>();</span><br><span class="line">    ArrayList&lt;CaffeineCache&gt; caches = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    caches.add(<span class="keyword">new</span> <span class="title class_">CaffeineCache</span>(cacheName(), generateCache()));</span><br><span class="line">    cacheManager.setCaches(caches);</span><br><span class="line">    <span class="keyword">return</span> cacheManager;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>需要注意的是，Spring 只支持手动加载和自动加载缓存，无法支持异步缓存</p><h3 id="使用-Cacheable-注解">使用 @Cacheable 注解</h3><p>为了使用 @Cacheable 注解，需要引入 Maven 依赖</p><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>与 @Cacheable 相关的常用注解包括：</p><ul><li>@Cachable：表示该方法支持缓存。当调用被注解的方法时，如果对应的键已经存在缓存，则不再执行方法体，而是从缓存中直接返回。</li><li>@CachePut：表示执行该方法后，其值将作为最新结果更新到缓存中</li><li>@CacheEvict：表示执行该方法后，将执行缓存清除操作</li><li>@Caching：组合前三个注解</li></ul><h3 id="常用注解属性">常用注解属性</h3><p>@Cacheable 常用的注解属性如下：</p><ul><li><code>cacheNames/value</code>：缓存组件的名字，即 cacheManager 中缓存的名称</li><li><code>key</code>：缓存数据时使用的 key</li><li><code>keyGenerator</code>：key 和 keyGenerator 二选一</li><li><code>cacheManager</code>：指定使用的缓存管理器</li><li><code>condition</code>：在方法执行开始前检查，在符合 condition 的情况下，进行缓存</li><li><code>unless</code>：在方法执行完成后检查，在符合 unless 的情况下，进行缓存</li><li><code>sync</code>：是否进行同步模式，若使用同步模式，在多个线程同时对一个 key 进行 load 时，其他线程将被阻塞</li></ul><h3 id="缓存同步模式">缓存同步模式</h3><p>@Cacheable 注解支持配置同步模式，在不同的 Caffeine 配置下，对是否开启同步模式进行观察</p><table><thead><tr><th>Caffeine缓存类型</th><th>是否开启同步</th><th>多线程读取不存在/被驱逐的 key</th><th>多线程读取待刷新的 key</th></tr></thead><tbody><tr><td>Cache</td><td>否</td><td>各自独立执行被注解方法</td><td>-</td></tr><tr><td>Cache</td><td>是</td><td>线程1执行被注解方法，线程2阻塞，直到缓存更新完成</td><td>-</td></tr><tr><td>LoadingCache</td><td>否</td><td>线程1执行 <code>load()</code>，线程2被阻塞，直到缓存更新完成</td><td>线程1使用旧值立即返回，并异步更新缓存值；线程2立即返回，不进行更新</td></tr><tr><td>LoadingCache</td><td>是</td><td>线程1执行被注解方法，线程2阻塞，直到缓存更新完成</td><td>线程1使用旧值立即返回，并异步更新缓存值；线程2立即返回，不进行更新</td></tr></tbody></table><ul><li>在 Cache 中，sync 表示是否需要所有线程同步等待</li><li>在 LoadingCache 中，sync 表示在读取不存在/被驱逐的 key 时，是否执行被注解方法</li></ul></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://yonagi04.github.io">Yonagi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://yonagi04.github.io/posts/2024/117a0a91f111/">https://yonagi04.github.io/posts/2024/117a0a91f111/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://yonagi04.github.io" target="_blank">Yonagi's Sekai</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/%E5%90%8E%E7%AB%AF/">后端</a><a class="post-meta__tags" href="/tags/Caffeine/">Caffeine</a><a class="post-meta__tags" href="/tags/%E7%BC%93%E5%AD%98%E6%8A%80%E6%9C%AF/">缓存技术</a></div><div class="post_share"><div class="social-share" data-image="/img/website/6.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://jsd.onmicrosoft.cn/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://jsd.onmicrosoft.cn/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/2024/f3f7b2c90e6a/" title="客户端秘因"><img class="cover" src="/img/website/1.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">客户端秘因</div></div></a></div><div class="next-post pull-right"><a href="/posts/2024/ec54d0d33ec7/" title="简谈设计模式之享元模式"><img class="cover" src="/img/website/3.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">简谈设计模式之享元模式</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/2024/b64cc63dd695/" title="JUC专题——Java中的锁"><img class="cover" src="/img/website/6.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-19</div><div class="title">JUC专题——Java中的锁</div></div></a></div><div><a href="/posts/2024/c7a9814e39de/" title="JUC专题——Java并发基础"><img class="cover" src="/img/website/1.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-16</div><div class="title">JUC专题——Java并发基础</div></div></a></div><div><a href="/posts/2024/6cc2fd2cd422/" title="JUC专题——Java并发机制的底层实现原理"><img class="cover" src="/img/website/4.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-16</div><div class="title">JUC专题——Java并发机制的底层实现原理</div></div></a></div><div><a href="/posts/2024/f5e67a38b282/" title="JVM专题——内存结构"><img class="cover" src="/img/website/4.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-05</div><div class="title">JVM专题——内存结构</div></div></a></div><div><a href="/posts/2024/bb3aa242277e/" title="JVM专题——垃圾回收"><img class="cover" src="/img/website/4.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-05</div><div class="title">JVM专题——垃圾回收</div></div></a></div><div><a href="/posts/2024/a27f69d2c877/" title="JVM专题——类文件加载"><img class="cover" src="/img/website/6.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-02</div><div class="title">JVM专题——类文件加载</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/website/avatar.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Yonagi</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">118</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Yonagi04"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/atom.xml" target="_blank"><i class="fas fa-rss"></i></a><a class="social-icon" href="mailto:katomakotocn@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://x.com/Akatsuki_1024" target="_blank" title="X"><i class="fab fa-twitter"></i></a><a class="social-icon" href="https://t.me/+NtQ_S0GDrRtiYmY1" target="_blank" title="Telegram"><i class="fab fa-telegram"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到Yonagi的世界，本站部分资料来源于互联网，若侵权请联系我删除。欢迎加入TG频道和我一起交流。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Caffeine-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">Caffeine 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8-Java-%E4%B8%AD%E4%BD%BF%E7%94%A8-Caffeine"><span class="toc-number">2.</span> <span class="toc-text">在 Java 中使用 Caffeine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.1.</span> <span class="toc-text">手动加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.2.</span> <span class="toc-text">自动加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.3.</span> <span class="toc-text">手动异步加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.4.</span> <span class="toc-text">自动异步加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A9%B1%E9%80%90%E7%AD%96%E7%95%A5"><span class="toc-number">2.5.</span> <span class="toc-text">驱逐策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%B7%E6%96%B0%E6%9C%BA%E5%88%B6"><span class="toc-number">2.6.</span> <span class="toc-text">刷新机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1"><span class="toc-number">2.7.</span> <span class="toc-text">统计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8-SpringBoot-%E4%B8%AD%E4%BD%BF%E7%94%A8-Caffeine"><span class="toc-number">3.</span> <span class="toc-text">在 SpringBoot 中使用 Caffeine</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringBoot-%E7%BC%93%E5%AD%98%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">3.1.</span> <span class="toc-text">SpringBoot 缓存管理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Cacheable-%E6%B3%A8%E8%A7%A3"><span class="toc-number">3.2.</span> <span class="toc-text">使用 @Cacheable 注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3%E5%B1%9E%E6%80%A7"><span class="toc-number">3.3.</span> <span class="toc-text">常用注解属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E5%90%8C%E6%AD%A5%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.4.</span> <span class="toc-text">缓存同步模式</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/2025/e4126e29285c/" title="第一次实习之北京之旅"><img src="/img/website/3.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="第一次实习之北京之旅"></a><div class="content"><a class="title" href="/posts/2025/e4126e29285c/" title="第一次实习之北京之旅">第一次实习之北京之旅</a><time datetime="2025-05-02T17:01:41.000Z" title="发表于 2025-05-02 17:01:41">2025-05-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2025/98f5159820c0/" title="我是如何学习日语的"><img src="/img/website/6.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="我是如何学习日语的"></a><div class="content"><a class="title" href="/posts/2025/98f5159820c0/" title="我是如何学习日语的">我是如何学习日语的</a><time datetime="2025-01-21T16:49:35.000Z" title="发表于 2025-01-21 16:49:35">2025-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2024/cfc2fe83dba5/" title="大日本帝国是如何被低智商民粹主义反噬的？"><img src="https://unpkg.com/yonagi-blog-repo-img@1.1.36/img/content/nippon-history/640.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="大日本帝国是如何被低智商民粹主义反噬的？"></a><div class="content"><a class="title" href="/posts/2024/cfc2fe83dba5/" title="大日本帝国是如何被低智商民粹主义反噬的？">大日本帝国是如何被低智商民粹主义反噬的？</a><time datetime="2024-12-30T10:44:01.000Z" title="发表于 2024-12-30 10:44:01">2024-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2024/eb8e8616b295/" title="以后的一点计划"><img src="/img/website/3.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="以后的一点计划"></a><div class="content"><a class="title" href="/posts/2024/eb8e8616b295/" title="以后的一点计划">以后的一点计划</a><time datetime="2024-12-21T20:10:23.000Z" title="发表于 2024-12-21 20:10:23">2024-12-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2024/1db1ad333570/" title="天气转寒，注意身体"><img src="/img/website/7.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="天气转寒，注意身体"></a><div class="content"><a class="title" href="/posts/2024/1db1ad333570/" title="天气转寒，注意身体">天气转寒，注意身体</a><time datetime="2024-12-09T17:25:30.000Z" title="发表于 2024-12-09 17:25:30">2024-12-09</time></div></div></div></div></div></div></main><footer id="footer" style="background:0 0"><div id="Jay-footer"><div class="footer-group"><h3 class="footer-title">直达</h3><div class="footer-links"><a class="footer-item" href="/zone/">Yonagi 说说</a><a class="footer-item" target="_blank" rel="noopener" href="https://music.yonagi04.cn">音乐</a><a class="footer-item" target="_blank" rel="noopener" href="https://hot.yonagi04.cn">今日热榜</a><a class="footer-item" target="_blank" rel="noopener" href="https://status.yonagi04.cn">站点监测</a><a class="footer-item" target="_blank" rel="noopener" href="https://tools.yonagi04.cn">实用工具</a></div></div><div class="footer-group"><h3 class="footer-title">关于</h3><div class="footer-links"><a class="footer-item" href="/about/">关于我</a><a class="footer-item" href="/atom.xml">RSS订阅</a><a class="footer-item" href="/update/">更新记录</a><a class="footer-item" href="/license/">版权声明</a><a class="footer-item" href="/privacy/">隐私政策</a></div></div><div class="footer-group"><h3 class="footer-title">文章</h3><div class="footer-links"><a class="footer-item" href="/archives/">时间轴</a><a class="footer-item" href="/tags/">标签</a><a class="footer-item" href="/categories/技术/">技术相关</a><a class="footer-item" href="/categories/生活/">生活点滴</a><a class="footer-item" href="/categories/">查看全部</a></div></div><div class="footer-group"><h3 class="footer-title">友链 <button class="fa-rotate-righ-button" href="javascript:;" onclick="flink_random.randomLink()" title="换一批"><i class="fa-rotate-right fa-solid"></i></button></h3><div class="footer-links" id="friend-links-in-footer"><a class="footer-item" href=""></a><a class="footer-item" href=""></a><a class="footer-item" href=""></a><a class="footer-item" href=""></a><a class="footer-item" data-pjax-state="" href="/link/">查看更多</a></div></div></div><div id="footer-banner"><div class="footer-banner-links"><div class="footer-banner-left"><div id="footer-banner-tips"><div class="copyright">© 2024 - 2025 By <a class="footer-banner-link" href="https://github.com/Yonagi04" rel="external nofollow" target="_blank" style="margin-left:10px">Yonagi</a></div></div><a class="footer-banner-link" target="_blank" rel="noopener" href="https://icp.gov.moe/?keyword=20241022">萌ICP备20241022</a></div><div class="footer-banner-right"><a class="footer-banner-link" target="_blank" rel="noopener" href="https://hexo.io/zh-cn/" title="Hexo">Hexo</a> <a class="footer-banner-link" target="_blank" rel="noopener" href="https://butterfly.js.org/" title="Butterfly">基于Butterfly深度定制</a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><a class="icon-V hidden" onclick="switchNightMode()" title="昼夜转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="nav-music"><div id="nav-music-hoverTips" onclick="yonagi.musicToggle()">播放音乐</div><meting-js id="2149662806" server="netease" type="playlist" mutex="true" preload="none" theme="var(--yonagi-main)" data-lrctype="0" order="random"></meting-js></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-music"><a class="rightMenu-item" href="javascript:yonagi.musicToggle();"><i class="fa fa-pause"></i><span>停止播放</span></a><a class="rightMenu-item" href="javascript:yonagi.musicSkipBack();"><i class="fa fa-backward-step"></i><span>上一曲</span></a><a class="rightMenu-item" href="javascript:yonagi.musicSkipForward();"><i class="fa fa-forward-step"></i><span>下一曲</span></a><a class="rightMenu-item" href="javascript:pasteName();"><i class="fa fa-copy"></i><span>获取歌曲名称</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="iconfont icon-baidu"></i><span>百度搜索</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.google.com/search?q=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-google"></i><span>Google搜索</span></a><a class="rightMenu-item" href="#post-comment" onclick="rmf.yinyong()"><i class="fa-solid fa-message"></i><span>引用文本评论</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.click()"><i class="fa fa-arrows-alt"></i><span>全屏显示</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="javascript:rmf.translate();"><i class="fa fa-language"></i><span>繁简转换</span></a><a class="rightMenu-item" href="javascript:fullScreen();"><i class="fas fa-expand"></i><span>进入全屏</span></a></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://jsd.onmicrosoft.cn/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://jsd.onmicrosoft.cn/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://jsd.onmicrosoft.cn/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.js"></script><div class="js-pjax"><script>(()=>{const a=()=>{new Valine(Object.assign({el:"#vcomment",appId:"ouQ2iZAa4RGTP9DYLXvEEpBY-MdYXbMMI",appKey:"c9ChnVvPoWKT5gfIcmhLFX0Q",avatar:"",serverURLs:"https://comment.yonagi04.cn",emojiCDN:"https://i0.hdslb.com/bfs/emote/",emojiMaps:{tv_doge:"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_親親":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_再見":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_發怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_發財":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_可愛":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_嘔吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_壞笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_尷尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_驚嚇":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png"},master:"0fb7e17b2a158aac035cdaf16b7bc7d1",tagMeta:["博主","小伙伴","访客"],friends:["bc0d77772d4ca1f1adb02ddb264bec9f","95b8f5169182d1ac9a1324b9c343d8fd"],metaPlaceholder:{nick:"昵称/QQ号",mail:"邮箱（完全保密）"},placeholder:"填写邮箱可以及时收到回复哦 :)",avatar:"wavatar",enableQQ:!0,path:window.location.pathname,visitor:!1},null))},e=async()=>{"function"==typeof Valine||await getScript("https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.8/js/Valine.min.js"),a()};btf.loadComment(document.getElementById("vcomment"),e)})()</script></div><script defer src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js"></script><script async src="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.18/js/pace.min.js"></script><script async src="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.18/js/randompost.min.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script async src="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.18/js/sun_moon.min.js"></script><script src="/js/navigate.js" data-pjax="" defer></script><script defer src="/js/rightmenu.js"></script><script defer src="/js/cursor.js"></script><script async src="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.33/js/welcome.min.js"></script><script defer src="/js/noie.js"></script><div id="fps"></div><script async data-pjax="" src="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.20/js/aplayer.min.js"></script><script async data-pjax="" src="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.20/js/aplayerfunction.min.js"></script><script async src="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.20/js/aplayeronlyone.min.js"></script><script async data-pjax="" src="https://cdn.smartcis.cn/npm/yonagi-blog-repo-img@1.1.20/js/flink_random.min.js"></script><script src="https://jsd.onmicrosoft.cn/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script id="click-heart" src="https://jsd.onmicrosoft.cn/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async mobile="false"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="/js/meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(btf.removeGlobalFnEvent("pjax"),btf.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://jsd.onmicrosoft.cn/npm/algoliasearch@4.22.1/dist/algoliasearch-lite.umd.min.js"></script><script src="https://jsd.onmicrosoft.cn/npm/instantsearch.js@4.65.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js?v=4.13.0"></script></div></div><script data-pjax="">function butterfly_swiper_injector_config(){var i=document.getElementById("recent-posts");console.log("已挂载butterfly_swiper"),i.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2024/d13d7d3eee3e/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/img/website/6.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2024/d13d7d3eee3e/&quot;);" href="javascript:void(0);" alt="">Java基础知识总结（上）</a><div class="blog-slider__text">Java技术栈系列</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2024/d13d7d3eee3e/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2024/7753445c1ab0/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/img/website/8.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-28</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2024/7753445c1ab0/&quot;);" href="javascript:void(0);" alt="">刷题日记 24.3.28</a><div class="blog-slider__text">第一篇刷题日记，现在刷题日记已经成为本站固定栏目</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2024/7753445c1ab0/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2024/248a3c61f59e/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/img/website/1.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-23</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2024/248a3c61f59e/&quot;);" href="javascript:void(0);" alt="">关于ACM的一点往事</a><div class="blog-slider__text">过去的一点往事</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2024/248a3c61f59e/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/2024/f8877bbf319d/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="/img/website/2.webp" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2024-03-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/2024/f8877bbf319d/&quot;);" href="javascript:void(0);" alt="">C++面向对象程序设计 知识点</a><div class="blog-slider__text">我写博客的起点，第一篇技术博客</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/2024/f8877bbf319d/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>')}for(var elist="undefined".split(","),cpage=location.pathname,epage="all",flag=0,i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_swiper_injector_config()</script><script defer src="https://jsd.onmicrosoft.cn/npm/yonagi-blog-repo-img@1.1.17/js/swiper/swiper.min.js"></script><script defer data-pjax="" src="https://jsd.onmicrosoft.cn/npm/yonagi-blog-repo-img@1.1.17/js/swiper/swiper_init.js"></script></body></html>